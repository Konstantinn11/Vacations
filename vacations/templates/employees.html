{% extends "base.html" %}
{% load cache %}
{% block title %}Сотрудники{% endblock %}
{% load user_filters %}
{% load static %}
{% block header %}
<title>Сотрудники</title>
<div style="display: flex; flex-direction: row; justify-content: left; align-items: center; flex-wrap: nowrap; width: 120%; margin-top: 25px;">
    <div style="display: flex; background-color: #f7f7f7; height: 46px; box-shadow: 0px 0px 5px rgba(0, 0, 0, 0.2); margin-left: 358px; border-radius: 1px; overflow: hidden; flex-grow: 1; width: auto;">
        <div class="header-tab" data-tab="departments">Отделы</div>
        <div class="header-tab active" data-tab="employees">Сотрудники</div>
        <div class="header-tab" data-tab="tags">Теги</div>
        {% if request.user.is_superuser %}
        <div class="header-tab" data-tab="archive">Архив</div>
        {% endif %}
    </div>
    {% if request.user.get_full_name in bosses %}
    <div style="display: flex; flex-direction: row; align-items: center; margin-left: 20px; gap: 20px; flex-grow: 1; justify-content: flex-end;">
        <a class="btn sib" style="background-color:#15a362; font-family: 'Calibri'; font-style: normal; font-weight: 400; width: 260px; height: 46px; font-size: 20px;
            padding: 0 10px; margin-right: -302px; border-radius: 5px; color: white; text-align: center; display: flex; align-items: center; justify-content: center;" href="{% url 'import_vacations' %}">
            <img style="height: 25px; margin-right: 5px; vertical-align: middle;" src="{% static 'circle_plus.png' %}">Добавить сотрудника
        </a>
    </div>
    {% endif %}
</div>

<style>
    .btn.sib:hover { background-color: rgba(21, 163, 98, 0.8) !important; }

    .header-tab {
        flex: 1;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
        cursor: pointer;
        font-size: 19px;
        transition: background-color 0.3s ease;
        color: #5d6778;
    }

    .header-tab:hover {
        background-color: rgba(21, 163, 98, 0.1);
        color: #15a362;
    }

    .header-tab.active {
        border-bottom: 3px solid #15a362;
        color: #15a362;
    }
</style>
{% endblock %}

{% block aside %}
    {% include 'includes/aside_vac_all.html' %}
{% endblock %}

{% block content %}
<script>
    document.addEventListener("DOMContentLoaded", function () {
        const tabs = document.querySelectorAll('.header-tab');

        tabs.forEach(tab => {
            tab.addEventListener('click', function () {
                const tabType = this.getAttribute('data-tab');
                const currentUrl = new URL(window.location.href);
                currentUrl.searchParams.set('tab', tabType);
                window.location.href = currentUrl; 
            });
        });

        const urlParams = new URLSearchParams(window.location.search);
        const activeTab = urlParams.get('tab') || 'employees'; 
        tabs.forEach(tab => {
            if (tab.getAttribute('data-tab') === activeTab) {
                tab.classList.add('active');
            } else {
                tab.classList.remove('active');
            }
        });
    });
</script>
{% endblock %}